!function(e,t){for(var i in t)e[i]=t[i]}(exports,function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t){e.exports=require("coc.nvim")},function(e,t){const i="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=i},function(e,t){const i=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:i,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{a(s.next(e))}catch(e){n(e)}}function c(e){try{a(s.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}a((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=i(0),n=i(4);t.activate=function(e){if(!r.workspace.isNvim)return r.workspace.showMessage("coc-actions only support neovim now!");const t=new n.Actions;e.subscriptions.push(t),e.subscriptions.push(r.commands.registerCommand("actions.open",(e,i="",r="")=>s(this,void 0,void 0,(function*(){t.openMenu(e,i,r)}))))}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{a(s.next(e))}catch(e){n(e)}}function c(e){try{a(s.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}a((s=s.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),o=r(i(5));t.Actions=class{constructor(){this.nameSpaceFlag="cco-actions-line",this.guiCursor="",this.subscriptions=[],this.codeActions=[],this.isRegisterAutocmd=!1,this.isUseCursorLine=!1,this.nvim=n.workspace.nvim,this.isUseCursorLine=n.workspace.getConfiguration("coc-actions").get("useCursorLine",!1)}openMenu(e,t,i){return s(this,void 0,void 0,(function*(){try{this.codeActions=yield this.getCodeActions(e)}catch(e){return void n.workspace.showMessage(`Get code actions error: ${e.message||e}`)}if(!this.codeActions.length)return;let s=this.codeActions.reduce((e,t)=>e>t.title.length?e:t.title.length,0),r=this.codeActions.map(e=>` ${e.title.padEnd(s," ")} `);if(s+=2,n.workspace.getConfiguration("coc-actions").get("showActionKind",!0)){const e=this.codeActions.reduce((e,t)=>t.kind&&e>t.kind.length?e:t.kind&&t.kind.length||1,0)+2,t=this.codeActions.map(t=>`[${t.kind||"-"}]`.padStart(e," "));r=r.map((e,i)=>`${e}${t[i]} `),s+=1+e}this.isUseCursorLine&&(r=r.map(e=>e.trimEnd()));const o=yield this.createBuf(r),c=yield this.nvim.getOption("lines"),a=yield this.nvim.call("winnr"),h=yield this.nvim.call("win_screenpos",a),l=yield this.nvim.call("winline");let u=c-h[0]-l,E="NW";r.length>u&&u/c<.5&&(u=c-u-2,E="SW"),t&&i&&(yield this.nvim.call("cursor",[t,i])),yield this.createWin(o,s,Math.min(u,r.length),E),this.addHighlight(0),this.registerAutocmd()}))}closeMenu(){return s(this,void 0,void 0,(function*(){this.win&&(this.win.valid&&this.win.close(!0),this.win=void 0,this.guiCursor&&n.workspace.getConfiguration("coc-actions").get("hideCursor",!0)&&(o.default(n.workspace.env.version,"0.5.0")&&this.nvim.setOption("guicursor",`${this.guiCursor},a:ver1-Cursor/lCursor`),this.nvim.setOption("guicursor",this.guiCursor),this.guiCursor=""),this.buf&&(this.buf.setOption("modifiable",!0),this.buf.remove(0,-1),this.buf.setOption("modifiable",!1)))}))}createWin(e,t,i,r){return s(this,void 0,void 0,(function*(){this.guiCursor=yield this.nvim.getOption("guicursor");const s=yield this.nvim.openFloatWindow(e,!0,{focusable:!0,relative:"cursor",anchor:r,height:i,width:t,row:"NW"===r?1:0,col:0});return this.nvim.pauseNotification(),s.setOption("relativenumber",!1),s.setOption("number",!1),s.setOption("wrap",!1),s.setOption("cursorline",this.isUseCursorLine),s.setOption("cursorcolumn",!1),s.setOption("conceallevel",2),s.setOption("signcolumn","no"),s.setOption("winhighlight","Normal:Pmenu,FoldColumn:Pmenu,CursorLine:PmenuSel"),s.setOption("listchars","trail: ,extends: "),s.setCursor([1,1]),o.default(n.workspace.env.version,"0.5.0")&&n.workspace.getConfiguration("coc-actions").get("hideCursor",!0)&&this.nvim.setOption("guicursor",`${this.guiCursor},a:ver1-CocCursorTransparent/lCursor`),yield this.nvim.resumeNotification(),this.win=s,s}))}createBuf(e){return s(this,void 0,void 0,(function*(){this.buf&&this.buf.valid||(this.buf=yield this.nvim.createNewBuffer(!1,!0),yield this.buf.setOption("filetype","cocactions"));const t=this.buf;return yield t.setOption("modifiable",!0),yield t.remove(0,-1),yield t.setLines(e,{start:0}),yield t.setOption("modifiable",!1),t}))}addHighlight(e){return s(this,void 0,void 0,(function*(){if(!this.win||!this.buf||this.isUseCursorLine)return;const t=yield this.nvim.createNamespace(this.nameSpaceFlag);this.buf.clearHighlight({srcId:t,lineStart:0,lineEnd:-1}),this.buf.addHighlight({hlGroup:"PmenuSel",line:e,colStart:0,colEnd:-1,srcId:t})}))}registerAutocmd(){this.isRegisterAutocmd||this.subscriptions.push(n.workspace.registerLocalKeymap("n","<cr>",()=>s(this,void 0,void 0,(function*(){const e=(yield this.nvim.callFunction("getcurpos"))[1]-1;yield this.closeMenu(),this.codeActions&&this.codeActions[e]&&setTimeout(()=>{this.applyCodeAction(this.codeActions[e])},100)})),!0),n.workspace.registerLocalKeymap("n","<esc>",()=>{this.closeMenu()},!0),n.workspace.registerLocalKeymap("n","<C-c>",()=>{this.closeMenu()},!0),n.workspace.registerLocalKeymap("n","<C-n>",()=>{this.nvim.feedKeys("j","n",!1)},!0),n.workspace.registerLocalKeymap("n","<C-p>",()=>{this.nvim.feedKeys("k","n",!1)},!0),n.workspace.registerAutocmd({event:"BufLeave",callback:()=>{this.closeMenu()}}),n.workspace.registerAutocmd({event:"CursorMoved",callback:()=>s(this,void 0,void 0,(function*(){if(!this.win||!this.buf)return;const e=yield this.nvim.callFunction("getcurpos");this.addHighlight(e[1]-1)}))}))}applyCodeAction(e){return s(this,void 0,void 0,(function*(){let{command:t,edit:i}=e;if(i&&(yield n.workspace.applyEdit(i)),t)if(n.commands.has(t.command))n.commands.execute(t);else{let i=e.clientId,s=n.services.getService(i),r={command:t.command,arguments:t.arguments};if(s.client){let{client:e}=s;e.sendRequest("workspace/executeCommand",r).then(void 0,e=>{n.workspace.showMessage(`Execute '${t.command} error: ${e}'`,"error")})}}}))}getCodeActions(e){return s(this,void 0,void 0,(function*(){const t=yield n.workspace.document;if(!t)return[];let i=null;if(e&&(i=yield n.workspace.getSelectedRange(e,t)),!i){const e=yield n.workspace.getCursorPosition();i=t.getWordRangeAtPosition(e)}if(!i){let e=yield n.workspace.nvim.call("line",["."]);i={start:{line:e-1,character:0},end:{line:e,character:0}}}let s={diagnostics:n.diagnosticManager.getDiagnosticsInRange(t.textDocument,i)},r=yield n.languages.getCodeActions(t.textDocument,i,s);if(!r)return[];let o=[];for(let e of r.keys()){let t=r.get(e);for(let i of t)o.push(Object.assign({clientId:e},i))}return o.sort((e,t)=>e.isPrefered&&!t.isPrefered?-1:t.isPrefered&&!e.isPrefered?1:0),o}))}dispose(){this.win&&(this.win.close(!0),this.win=void 0),this.buf&&(this.buf=void 0),this.subscriptions.length&&(this.subscriptions.forEach(e=>{e.dispose()}),this.subscriptions=[]),this.isRegisterAutocmd=!1}}},function(e,t,i){const s=i(6);e.exports=(e,t,i)=>s(e,t,i)>=0},function(e,t,i){const s=i(7);e.exports=(e,t,i)=>new s(e,i).compare(new s(t,i))},function(e,t,i){const s=i(1),{MAX_LENGTH:r,MAX_SAFE_INTEGER:n}=i(2),{re:o,t:c}=i(8),{compareIdentifiers:a}=i(9);class h{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=e.trim().match(t.loose?o[c.LOOSE]:o[c.FULL]);if(!i)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof h)){if("string"==typeof e&&e===this.version)return 0;e=new h(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof h||(e=new h(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)}comparePre(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],r=e.prerelease[t];if(s("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return a(i,r)}while(++t)}compareBuild(e){e instanceof h||(e=new h(e,this.options));let t=0;do{const i=this.build[t],r=e.build[t];if(s("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return a(i,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=h},function(e,t,i){const{MAX_SAFE_COMPONENT_LENGTH:s}=i(2),r=i(1),n=(t=e.exports={}).re=[],o=t.src=[],c=t.t={};let a=0;const h=(e,t,i)=>{const s=a++;r(s,t),c[e]=s,o[s]=t,n[s]=new RegExp(t,i?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","[0-9]+"),h("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),h("MAINVERSION",`(${o[c.NUMERICIDENTIFIER]})\\.`+`(${o[c.NUMERICIDENTIFIER]})\\.`+`(${o[c.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${o[c.NUMERICIDENTIFIERLOOSE]})\\.`+`(${o[c.NUMERICIDENTIFIERLOOSE]})\\.`+`(${o[c.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${o[c.NUMERICIDENTIFIER]}|${o[c.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${o[c.NUMERICIDENTIFIERLOOSE]}|${o[c.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${o[c.PRERELEASEIDENTIFIER]}(?:\\.${o[c.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${o[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[c.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER","[0-9A-Za-z-]+"),h("BUILD",`(?:\\+(${o[c.BUILDIDENTIFIER]}(?:\\.${o[c.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${o[c.MAINVERSION]}${o[c.PRERELEASE]}?${o[c.BUILD]}?`),h("FULL",`^${o[c.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${o[c.MAINVERSIONLOOSE]}${o[c.PRERELEASELOOSE]}?${o[c.BUILD]}?`),h("LOOSE",`^${o[c.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${o[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${o[c.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${o[c.XRANGEIDENTIFIER]})`+`(?:\\.(${o[c.XRANGEIDENTIFIER]})`+`(?:\\.(${o[c.XRANGEIDENTIFIER]})`+`(?:${o[c.PRERELEASE]})?${o[c.BUILD]}?`+")?)?"),h("XRANGEPLAINLOOSE",`[v=\\s]*(${o[c.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})`+`(?:${o[c.PRERELEASELOOSE]})?${o[c.BUILD]}?`+")?)?"),h("XRANGE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAINLOOSE]}$`),h("COERCE",`(^|[^\\d])(\\d{1,${s}})`+`(?:\\.(\\d{1,${s}}))?`+`(?:\\.(\\d{1,${s}}))?`+"(?:$|[^\\d])"),h("COERCERTL",o[c.COERCE],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${o[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${o[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${o[c.LONECARET]}${o[c.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${o[c.LONECARET]}${o[c.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${o[c.GTLT]}\\s*(${o[c.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]}|${o[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${o[c.XRANGEPLAIN]})`+"\\s+-\\s+"+`(${o[c.XRANGEPLAIN]})`+"\\s*$"),h("HYPHENRANGELOOSE",`^\\s*(${o[c.XRANGEPLAINLOOSE]})`+"\\s+-\\s+"+`(${o[c.XRANGEPLAINLOOSE]})`+"\\s*$"),h("STAR","(<|>)?=?\\s*\\*")},function(e,t){const i=/^[0-9]+$/,s=(e,t)=>{const s=i.test(e),r=i.test(t);return s&&r&&(e=+e,t=+t),e===t?0:s&&!r?-1:r&&!s?1:e<t?-1:1};e.exports={compareIdentifiers:s,rcompareIdentifiers:(e,t)=>s(t,e)}}]));